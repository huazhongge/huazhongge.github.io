{"title":"【笔记】运筹学整理（2） - 线性规划的对偶理论与灵敏度分析","date":"2019-04-01T10:00:40.000Z","slug":"3-2","comments":true,"tags":["运筹学"],"categories":["笔记"],"updated":"2019-04-02T03:02:51.836Z","content":"<ul>\n<li>每个线性问题都存在一个与它对偶的问题，在求出每个问题解的时候，也同时给出了另一个问题的解。</li>\n<li>当周围条件变化时，我们需要对系统或事物对变化显示出来的敏感程度进行分析<a id=\"more\"></a></li>\n</ul>\n<h2 id=\"线性规划的对偶理论\">线性规划的对偶理论<a href=\"post/3-2#线性规划的对偶理论\"></a></h2><h3 id=\"对偶问题理论\">对偶问题理论<a href=\"post/3-2#对偶问题理论\"></a></h3><ul>\n<li><p>案例：A公司计划制造I、II两种产品，已知各制造一件时分别占用设备A、B的台时、调试工序的时间、每天可用于这两种产品的能力、各售出一件获得的利润如下表所示：<br>$$<br>\\begin{array}{c|c|c|c}<br>\\hline<br>{项目}&amp;{\\quad I\\quad }&amp;{\\quad II\\quad }&amp;{每天可用能力}\\\\<br>\\hline<br>{设备A/h}&amp;{\\quad 0\\quad }&amp;{\\quad 5\\quad }&amp;{\\quad 15\\quad }\\\\<br>{设备B/h}&amp;{\\quad 6\\quad }&amp;{\\quad 2\\quad }&amp;{\\quad 24\\quad }\\\\<br>{调试工序/h}&amp;{\\quad 1\\quad }&amp;{\\quad 1\\quad }&amp;{\\quad 5\\quad }\\\\<br>\\hline<br>{利润/元}&amp;{\\quad 2\\quad }&amp;{\\quad 1\\quad }&amp;{ }\\\\<br>\\hline<br>\\end{array}<br>$$</p>\n<ul>\n<li>由上一章内容我们可以得出其线性规划问题如下，这正是上一章单纯形法的案例：</li>\n</ul>\n<p>$$<br>max\\ z=2x_1+x_2\\\\<br>s.t.\\begin{cases}<br>\\quad \\quad \\ \\ \\ 5x_2\\leqslant15\\\\<br>6x_1+2x_2\\leqslant24\\\\<br>\\ \\ x_1+\\ \\ x_2\\leqslant5\\\\<br>\\ \\quad x_1,x_2\\geqslant0\\\\<br>\\end{cases}<br>$$</p>\n</li>\n</ul>\n<ul>\n<li><p>现从另一个角度提出问题，假定另外一家公司B想把A公司的资源收买过来，至少付出多大的代价，才能让A公司愿意放弃生产、出让自己的资源。显然，出让代价不低于同等资源下A公司的盈利，A公司才乐意出让</p>\n<ul>\n<li>设 $y_1,y_2,y_3$ 分别代表单位时间（$h$）设备$A$、$B$和调试工序的出让代价。因A公司用 $6h$ 设备$B$和 $1h$ 调试工序可以生产一件产品$I$，同理，A公司用 $5h$ 设备 $A$、$2h$ 设备 $B$ 和 $1h$ 调试工序可生产一件产品$II$，所以， $y_1,y_2,y_3$ 应满足以下约束：<br>$$<br>\\begin{cases}<br>\\quad \\quad \\ \\ \\ 6y_2+y_3\\geqslant2\\\\<br>5y_1+2y_2+y_3\\geqslant1\\\\<br>\\end{cases}<br>$$</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li><p>B公司又想用最小的代价把A公司的资源收买，即：<br>$$<br>min\\ z=15y_1+24y_2+5y_3<br>$$</p>\n</li>\n<li><p>整合该问题后得到的就是原问题的对偶问题：<br>$$<br>min\\ w=15y_1+24y_2+5y_3\\\\<br>s.t.\\begin{cases}<br>\\quad \\quad \\ \\ \\ 6y_2+y_3\\geqslant2\\\\<br>5y_1+2y_2+y_3\\geqslant1\\\\<br>\\ \\quad y_1,y_2,y_3\\geqslant0\\\\<br>\\end{cases}<br>$$</p>\n</li>\n</ul>\n<h3 id=\"对偶问题形式\">对偶问题形式<a href=\"post/3-2#对偶问题形式\"></a></h3><ul>\n<li><p>对称形式下，原问题与对偶问题可直接转换<br>$$<br>Max\\ Z=CX<br>~~<br>&lt;=&gt;<br>~~<br>Min\\ Z=Y^Tb 　　　　　　　　　　　　　　\\\\<br>s.t.<br>\\begin{cases}<br>\\ AX\\leqslant b\\\\<br>\\ x\\geqslant 0 \\\\<br>\\end{cases}<br>~~<br>&lt;=&gt;<br>~~<br>s.t.<br>\\begin{cases}<br>\\ A^TY\\geqslant C^T\\\\<br>\\ Y\\geqslant 0 ,\\ Y是列向量,\\ Y=(y_1,y_2,…,y_m)^T\\\\<br>\\end{cases}<br>$$</p>\n</li>\n<li><p>非对称形式下<br>$$<br>\\begin{array}{c|c|c}<br>\\hline<br>{项目}&amp;{原问题（对偶问题）}&amp;{对偶问题（原问题）}\\\\<br>\\hline<br>{A}&amp;{约束系数矩阵}&amp;{约束系数矩阵的转置}\\\\<br>{b}&amp;{约束条件右端项变量}&amp;{目标函数中的价格系数向量}\\\\<br>{C}&amp;{目标函数中的价格系数向量}&amp;{约束条件右端项变量}\\\\<br>{目标函数}&amp;{max\\ z=\\sum_{j=1}^nc_jx_j}&amp;{min\\ w=\\sum_{i=1}^mb_iy_i}\\\\<br>\\hline<br>{ }&amp;{变量<br>\\begin{cases}<br>x_j\\ (j=1,…,n)\\\\<br>x_j\\geqslant 0\\\\<br>x_j\\leqslant 0\\\\<br>x_j\\ 无约束\\\\<br>\\end{cases}}&amp;{约束条件<br>\\begin{cases}<br>有\\ n\\ 个(j=1,…,n)\\\\<br>\\sum_{i=1}^ma_{ij}y_i\\geqslant c_j\\\\<br>\\sum_{i=1}^ma_{ij}y_i\\leqslant c_j\\\\<br>\\sum_{i=1}^ma_{ij}y_i= c_j\\\\<br>\\end{cases}}\\\\<br>\\hline<br>{ }&amp;{约束条件<br>\\begin{cases}<br>有\\ m\\ 个(i=1,…,m)\\\\<br>\\sum_{j=1}^na_{ij}x_j\\leqslant b_i\\\\<br>\\sum_{j=1}^na_{ij}x_j\\geqslant b_i\\\\<br>\\sum_{j=1}^na_{ij}x_j= b_i\\\\<br>\\end{cases}}&amp;{变量<br>\\begin{cases}<br>y_i\\ (i=1,…,n)\\\\<br>y_i\\geqslant 0\\\\<br>y_i\\leqslant 0\\\\<br>y_i\\ 无约束\\\\<br>\\end{cases}}\\\\<br>\\hline<br>\\end{array}<br>$$</p>\n<ul>\n<li>原问题目标函数若求最大值，变量和约束条件转化时，对偶问题的约束条件符号与原问题对应的变量符号相同，对偶问题的变量符号与原问题的约束条件符号相反。</li>\n<li>若原问题目标函数求最小值，规则相反。</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"单纯形法的一些推导和理解\">单纯形法的一些推导和理解<a href=\"post/3-2#单纯形法的一些推导和理解\"></a></h3><ul>\n<li><p>案例：设置一个原问题和对偶问题为对称形式的线性规划问题，即原问题的标准形式如下：<br>$$<br>max\\ z=CX+0X_S\\\\<br>s.t.<br>\\begin{cases}<br>\\ AX+IX_S= b\\\\<br>\\ X\\geqslant 0,\\ X_S\\geqslant 0\\\\<br>\\end{cases}<br>$$</p>\n<ul>\n<li>其中 $X_S$为松弛变量，$X_S=(x_{n+1},…,x_{n+m})^T$，$I$ 为m X m的单位矩阵</li>\n<li>单纯形法计算时，总选择 $I$ 为初始基，对应基变量为 $X_S$</li>\n<li>初始单纯形表经若干次迭代后可得到最终单纯形表如下：</li>\n</ul>\n</li>\n</ul>\n<p>$$<br>\\begin{array}{ccc|cc|c}<br>\\hline<br>{ }&amp;{ }&amp;{ }&amp;{非基}&amp;{变量}&amp;{基变量}\\\\<br>\\hline<br>{C_b}&amp;{基}&amp;{b}&amp;{\\quad X_B\\quad }&amp;{\\quad \\quad X_N\\quad \\quad }&amp;{\\quad X_S\\quad }\\\\<br>\\hline<br>{0}&amp;{X_S}&amp;{b}&amp;{\\quad B\\quad }&amp;{\\quad \\quad N\\quad \\quad }&amp;{\\quad I\\quad }\\\\<br>\\hline<br>{ }&amp;{c_j-z_i}&amp;{ }&amp;{\\quad C_B\\quad }&amp;{\\quad \\quad C_N\\quad \\quad }&amp;{\\quad 0\\quad }\\\\<br>\\hline<br>\\end{array}\\\\<br>多次\\downarrow迭代\\\\<br>\\begin{array}{ccc|c|cc}<br>\\hline<br>{ }&amp;{ }&amp;{ }&amp;{基变量}&amp;{非基}&amp;{变量}\\\\<br>\\hline<br>{C_b}&amp;{基}&amp;{b}&amp;{X_B}&amp;{X_N}&amp;{X_S}\\\\<br>\\hline<br>{C_B}&amp;{X_B}&amp;{B^{-1}b}&amp;{I}&amp;{B^{-1}N}&amp;{B^{-1}}\\\\<br>\\hline<br>{ }&amp;{c_j-z_i}&amp;{ }&amp;{0}&amp;{C_N-C_BB^{-1}N}&amp;{-C_BB^{-1}}\\\\<br>\\hline<br>\\end{array}\\\\<br>$$</p>\n<ul>\n<li>推导和理解<ul>\n<li>初始单纯形表中的单位矩阵 $I$ 对应最终单纯形表中的 $B^{-1}$，而初始表中的 $B$ 和 $N$ 则分别变成 $I$ 和 $B^{-1}N$，即初始表中的系数矩阵左乘 $B^{-1}$得到最终单纯形表中的系数矩阵</li>\n<li>初始单纯形表中的基变量 $X_S=b$ 也左乘 $B^{-1}$ 后得到最终表中的 $X_B=B^{-1}b$</li>\n<li>松弛变量 $X_S$最终的检验数为 $-C_BB^{-1}$，我们称它的相反数 $C_BB^{-1}$为单纯形乘子</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"对偶问题性质\">对偶问题性质<a href=\"post/3-2#对偶问题性质\"></a></h3><ul>\n<li>对称性，对偶问题的对偶为原问题</li>\n<li>弱对偶性<ul>\n<li>若原问题有无界解，对偶问题无可行解；对偶问题有无界解，原问题无可行解</li>\n<li>若原问题无可行解，对偶问题具有无界解或无可行解；反之亦然</li>\n<li>若原问题有可行解而对偶函数无可行解，则原问题目标函数无界；反之亦然</li>\n</ul>\n</li>\n<li>最优性，若 $x^1$为原问题可行解，$y^1$为对偶问题可行解，当 $cx^1=y^1b$ 时，$x^1、y^1$为最优解</li>\n<li>强对偶性，若原问题和对偶问题均有可行解，则两者均具有最优解，且最优解目标函数值相等</li>\n<li>互补松弛性（建议领会影子价格后再理解这一条）<ul>\n<li>如果在最优条件下一个约束条件不是等式，那么这个约束对应的影子价格（即对偶问题的最优解）为0</li>\n<li>如果这个约束对应的影子价格严格大于0，则该约束条件一定是等式</li>\n<li>加深理解可移步这位同学的<a href=\"https://www.zhihu.com/question/27471863/answer/123244103\" target=\"_blank\" rel=\"noopener\">知乎</a>，回答很明白</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"影子价格\">影子价格<a href=\"post/3-2#影子价格\"></a></h3><ul>\n<li><p>案例：某公司消耗某种资源进行生产，原本的该资源的约束为最多消耗10，即 $b=10$，收益为100，现在放宽约束为最多消耗11，即 $b^1=11$，收益增加为110，那么<strong>影子价格</strong>就是放宽一个约束后增加的收益10</p>\n<ul>\n<li>通俗讲，影子价格就是在调整约束右边常数项（即资源量）时，目标函数的变化率</li>\n<li>如果市场价格低于某种资源的成本加上影子价格，可以买进；相反则可以卖出</li>\n<li>在单纯形表中，影子价格就是 $C_BB^{-1}$（即单纯形乘子），也是对偶问题的最优解</li>\n<li>当影子价格不为0时，表明该资源刚好耗尽，否则资源未被充分利用</li>\n</ul>\n</li>\n<li><p>案例：单纯形表中各检验数的经济意义<br>$$<br>\\sigma_j=c_j-C_BB^{-1}P_j=c_j-\\sum_{i=1}^ma_{ij}y_i<br>$$</p>\n<ul>\n<li>式中 $c_j$为第 j 种产品的利润，$\\sum_{i=1}^ma_{ij}y_i$为生产该产品所消耗各项资源的影子价格的总和，即产品的隐含成本</li>\n<li>当产品利润大于隐含成本时，表明生产该产品有利，可安排生产，否则，这些资源生产别的产品更有利，所以不安排生产</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"对偶单纯形法\">对偶单纯形法<a href=\"post/3-2#对偶单纯形法\"></a></h3><h2 id=\"线性规划的灵敏度分析\">线性规划的灵敏度分析<a href=\"post/3-2#线性规划的灵敏度分析\"></a></h2><h3 id=\"分析-cj-的变化\">分析 c<sub>j</sub> 的变化<a href=\"post/3-2#分析-cj-的变化\"></a></h3><h3 id=\"分析-bi-的变化\">分析 b<sub>i </sub>的变化<a href=\"post/3-2#分析-bi-的变化\"></a></h3><h3 id=\"增加变量xj-的分析\">增加变量x<sub>j</sub> 的分析<a href=\"post/3-2#增加变量xj-的分析\"></a></h3><h3 id=\"增加约束条件的分析\">增加约束条件的分析<a href=\"post/3-2#增加约束条件的分析\"></a></h3><h2 id=\"索引\">索引<a href=\"post/3-2#索引\"></a></h2><ul>\n<li><a href=\"http://qingluanke.club/post/3-1\" target=\"_blank\" rel=\"noopener\">【笔记】运筹学整理（1） - 线性规划的一般问题求解</a></li>\n</ul>\n","next":{"title":"【转载】2000年美国总统大选戈尔败选声明","slug":"5-1"},"link":"http://huazhongge.github.io/post/3-2/","toc":[{"title":"线性规划的对偶理论","id":"线性规划的对偶理论","index":"1","children":[{"title":"对偶问题理论","id":"对偶问题理论","index":"1.1"},{"title":"对偶问题形式","id":"对偶问题形式","index":"1.2"},{"title":"单纯形法的一些推导和理解","id":"单纯形法的一些推导和理解","index":"1.3"},{"title":"对偶问题性质","id":"对偶问题性质","index":"1.4"},{"title":"影子价格","id":"影子价格","index":"1.5"},{"title":"增加约束条件的分析","id":"增加约束条件的分析","index":"1.6"}]},{"title":"索引","id":"索引","index":"2"}],"copyright":{"author":"画中","link":"<a href=\"http://huazhongge.github.io/post/3-2/\" title=\"【笔记】运筹学整理（2） - 线性规划的对偶理论与灵敏度分析\">http://huazhongge.github.io/post/3-2/</a>","license":"Attribution-NonCommercial-NoDerivatives 4.0 International (<a href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/\" rel=\"external nofollow noopener\" target=\"_blank\">CC BY-NC-ND 4.0</a>)"}}